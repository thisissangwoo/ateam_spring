<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="wcustomer.mapper">

<!-- Q&A 전체 글 목록 조회 -->  

	<select id="qnalist" resultType="web_customer.CustomerVO">
	 	select rownum no, n.*, (select user_name from anafor_user where user_id = n.writer) name
	 	from (select * from notice where code = 'N03' order by id) n
	 	order by no desc
	</select>

<!-- Q&A 상세 내용 조회 -->

	<select id="qnadetail" resultType="web_customer.CustomerVO">
		select n.*, (select user_name from anafor_user where user_id = n.writer) name
		from notice n
		where id = #{id}
		and code = 'N03'
	</select>
	
<!-- 상세화면 조회 전 조회수 증가(변경) -->
	<update id="qnaread">
		update notice set readcnt = readcnt + 1
		where id = #{id}
	</update>	
	
<!-- 공지사항 신규 글 등록 처리 -->
	<insert id="insert">
		insert into notice (id, root, title, content, writer, filename, filepath, code)
		values ( seq_notice.nextval, seq_notice.currval , #{title}, #{content}, #{writer},
				#{filename, jdbcType=VARCHAR}, #{filepath, jdbcType=VARCHAR}, 'N03')
	</insert>		
</mapper>